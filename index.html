<!DOCTYPE html>
<html>

<head>
    <title>Album Arcade</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .shadow-neon {
            box-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00, 0 0 15px #00ff00;
        }

        @keyframes glow {

            0%,
            100% {
                box-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00, 0 0 15px #00ff00;
            }

            50% {
                box-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00, 0 0 30px #00ff00;
            }
        }

        .animate-glow {
            animation: glow 2s ease-in-out infinite;
        }
    </style>
</head>

<body class="bg-[#121212]">
    <div id="root"></div>
    <script type="text/babel">
        const MusicLibrary = () => {
            const [albums, setAlbums] = React.useState(() => {
                const saved = localStorage.getItem('musicLibrary');
                return saved ? JSON.parse(saved) : [];
            });
            const [newAlbum, setNewAlbum] = React.useState('');
            const [newArtist, setNewArtist] = React.useState('');
            const [selectedAlbum, setSelectedAlbum] = React.useState(null);
            const [showUpload, setShowUpload] = React.useState(false);
            const [showLibrary, setShowLibrary] = React.useState(true);
            const [filterText, setFilterText] = React.useState('');
            const [yearFilter, setYearFilter] = React.useState('');
            const [genreFilter, setGenreFilter] = React.useState('');

            // Keep existing state management and effect hooks...

            const years = React.useMemo(() =>
                Array.from(new Set(albums.map(a => a.year))).sort().filter(Boolean),
                [albums]
            );

            const genres = React.useMemo(() =>
                Array.from(new Set(albums.map(a => a.genre))).sort().filter(Boolean),
                [albums]
            );

            const filteredAlbums = React.useMemo(() => {
                return albums.filter(album => {
                    const matchesSearch = !filterText ||
                        album.album.toLowerCase().includes(filterText.toLowerCase()) ||
                        album.artist.toLowerCase().includes(filterText.toLowerCase());
                    const matchesYear = !yearFilter || album.year === yearFilter;
                    const matchesGenre = !genreFilter || album.genre === genreFilter;
                    return matchesSearch && matchesYear && matchesGenre;
                });
            }, [albums, filterText, yearFilter, genreFilter]);

            const handleFileUpload = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const parser = new DOMParser();
                        const xml = parser.parseFromString(e.target.result, "text/xml");
                        const tracks = xml.getElementsByTagName("dict")[0].getElementsByTagName("dict");
                        const newAlbums = new Set();

                        for (let track of tracks) {
                            const keys = track.getElementsByTagName("key");
                            let albumName = "";
                            let artistName = "";
                            let year = "";
                            let genre = "";

                            for (let i = 0; i < keys.length; i++) {
                                switch (keys[i].textContent) {
                                    case "Album":
                                        albumName = keys[i].nextElementSibling.textContent;
                                        break;
                                    case "Artist":
                                        artistName = keys[i].nextElementSibling.textContent;
                                        break;
                                    case "Year":
                                        year = keys[i].nextElementSibling.textContent;
                                        break;
                                    case "Genre":
                                        genre = keys[i].nextElementSibling.textContent;
                                        break;
                                }
                            }

                            if (albumName && artistName) {
                                newAlbums.add(JSON.stringify({
                                    album: albumName,
                                    artist: artistName,
                                    year: year || 'Unknown',
                                    genre: genre || 'Unknown',
                                    listens: 0,
                                    skips: 0
                                }));
                            }
                        }

                        const albumsArray = Array.from(newAlbums).map(item => JSON.parse(item));

                        setAlbums(prevAlbums => {
                            const combined = [...prevAlbums, ...albumsArray];
                            const unique = Array.from(new Set(combined.map(a => JSON.stringify(a))))
                                .map(item => JSON.parse(item));
                            return unique;
                        });

                        alert(`Successfully imported ${albumsArray.length} albums!`);
                    };
                    reader.readAsText(file);
                }
            };
            const pickRandomAlbum = () => {
                if (filteredAlbums.length > 0) {
                    const randomIndex = Math.floor(Math.random() * filteredAlbums.length);
                    setSelectedAlbum(filteredAlbums[randomIndex]);
                }
            };
            const copyToClipboard = () => {
                if (selectedAlbum) {
                    const textToCopy = `${selectedAlbum.album} ${selectedAlbum.artist}`;
                    navigator.clipboard.writeText(textToCopy)
                        .then(() => {
                            alert('Copied to clipboard!');
                        })
                        .catch(() => {
                            alert('Failed to copy');
                        });
                }
            };
            return (
                <div className="max-w-7xl mx-auto p-4 min-h-screen text-white">
                    {/* Header */}
                    <div className="bg-gradient-to-r from-[#4a148c] to-[#311b92] p-6 rounded-t-lg flex items-center justify-between border-b-4 border-[#00ff00] animate-glow">
                        <div className="flex items-center gap-3">
                            <svg className="w-8 h-8" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                            </svg>
                            <h1 className="text-3xl font-bold text-[#00ff00]">ALBUM ARCADE</h1>
                        </div>
                        <button
                            onClick={() => setShowLibrary(!showLibrary)}
                            className="px-4 py-2 bg-[#00ff00] text-black rounded hover:bg-[#00dd00] font-bold"
                        >
                            [ {showLibrary ? 'HIDE' : 'SHOW'} LIBRARY ]
                        </button>
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                        {/* Left Column - Controls */}
                        <div className="bg-[#1e1e1e] rounded-b-lg p-6 space-y-6 border border-[#333]">
                            {/* Search and Filters */}
                            <div className="space-y-4">
                                <input
                                    type="text"
                                    placeholder="Search albums or artists..."
                                    value={filterText}
                                    onChange={(e) => setFilterText(e.target.value)}
                                    className="w-full px-4 py-3 bg-[#2a2a2a] border border-[#00ff00] rounded text-[#00ff00] placeholder-[#00ff00]/50"
                                />

                                <div className="flex gap-4">
                                    <select
                                        value={yearFilter}
                                        onChange={(e) => setYearFilter(e.target.value)}
                                        className="flex-1 px-4 py-2 bg-[#2a2a2a] border border-[#00ff00] rounded text-[#00ff00]"
                                    >
                                        <option value="">[ ALL YEARS ]</option>
                                        {years.map(year => (
                                            <option key={year} value={year}>{year}</option>
                                        ))}
                                    </select>

                                    <select
                                        value={genreFilter}
                                        onChange={(e) => setGenreFilter(e.target.value)}
                                        className="flex-1 px-4 py-2 bg-[#2a2a2a] border border-[#00ff00] rounded text-[#00ff00]"
                                    >
                                        <option value="">[ ALL GENRES ]</option>
                                        {genres.map(genre => (
                                            <option key={genre} value={genre}>{genre}</option>
                                        ))}
                                    </select>
                                </div>
                            </div>

                            {/* Random Album Button */}
                            <button
                                onClick={pickRandomAlbum}
                                className="w-full px-6 py-4 bg-[#4a148c] text-[#00ff00] rounded font-bold text-lg border-2 border-[#00ff00] hover:bg-[#311b92] animate-glow"
                                disabled={filteredAlbums.length === 0}
                            >
                                [ PICK RANDOM ALBUM - {filteredAlbums.length} IN QUEUE ]
                            </button>

                            {/* Selected Album */}
                            {selectedAlbum && (
                                <div className="bg-[#2a2a2a] rounded p-6 border-2 border-[#00ff00] animate-glow">
                                    <div className="text-center space-y-4">
                                        <div className="text-[#00ff00] font-bold flex items-center justify-center gap-2">
                                            NOW PLAYING
                                            <button
                                                onClick={copyToClipboard}
                                                className="hover:text-white"
                                                title="Copy to clipboard"
                                            >
                                                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                                </svg>
                                            </button>
                                        </div>
                                        <h3 className="text-2xl font-bold">{selectedAlbum.album}</h3>
                                        <p className="text-lg text-gray-400">{selectedAlbum.artist}</p>
                                        <div className="flex gap-4">
                                            <button
                                                onClick={handleListen}
                                                className="flex-1 py-3 bg-[#1db954] text-white rounded font-bold hover:bg-[#1ed760]"
                                            >
                                                [ LISTENED ]
                                            </button>
                                            <button
                                                onClick={handleSkip}
                                                className="flex-1 py-3 bg-[#ff1744] text-white rounded font-bold hover:bg-[#ff4569]"
                                            >
                                                [ SKIP ]
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Upload Section */}
                            <div className="border-t border-[#333] pt-4">
                                <button
                                    onClick={() => setShowUpload(!showUpload)}
                                    className="text-[#00ff00] hover:text-[#00dd00]"
                                >
                                    [ {showUpload ? 'HIDE' : 'SHOW'} UPLOAD OPTIONS ]
                                </button>

                                {showUpload && (
                                    <div className="mt-4 p-4 bg-[#2a2a2a] rounded border border-[#333]">
                                        <input
                                            type="file"
                                            accept=".xml"
                                            onChange={handleFileUpload}
                                            className="w-full p-2 mb-4 bg-[#1e1e1e] border border-[#00ff00] rounded text-[#00ff00]"
                                        />
                                        <div className="flex gap-2">
                                            <input
                                                type="text"
                                                placeholder="Album name"
                                                value={newAlbum}
                                                onChange={(e) => setNewAlbum(e.target.value)}
                                                className="flex-1 px-4 py-2 bg-[#1e1e1e] border border-[#00ff00] rounded text-[#00ff00]"
                                            />
                                            <input
                                                type="text"
                                                placeholder="Artist"
                                                value={newArtist}
                                                onChange={(e) => setNewArtist(e.target.value)}
                                                className="flex-1 px-4 py-2 bg-[#1e1e1e] border border-[#00ff00] rounded text-[#00ff00]"
                                            />
                                            <button
                                                onClick={addAlbum}
                                                className="px-4 py-2 bg-[#00ff00] text-black rounded font-bold hover:bg-[#00dd00]"
                                            >
                                                [ ADD ]
                                            </button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Right Column - Library */}
                        {showLibrary && (
                            <div className="bg-[#1e1e1e] rounded-b-lg border border-[#333]">
                                <div className="p-4 border-b border-[#333] flex justify-between items-center">
                                    <h2 className="text-xl font-bold text-[#00ff00]">YOUR COLLECTION</h2>
                                    <div className="text-sm text-gray-400">
                                        {filteredAlbums.length} albums
                                    </div>
                                </div>
                                <div className="h-[calc(100vh-16rem)] overflow-y-auto">
                                    <div className="p-4 space-y-2">
                                        {filteredAlbums.map((item, index) => (
                                            <div key={index} className="flex justify-between items-start p-3 bg-[#2a2a2a] rounded hover:bg-[#333] border border-[#333] group">
                                                <div className="flex-1">
                                                    <div className="font-medium">{item.album}</div>
                                                    <div className="text-sm text-gray-400">{item.artist}</div>
                                                    <div className="text-xs text-gray-500">
                                                        {item.year} â€¢ {item.genre}
                                                    </div>
                                                    <div className="text-xs text-gray-500 mt-1">
                                                        Plays: {item.listens || 0} | Skips: {item.skips || 0}
                                                    </div>
                                                </div>
                                                <button
                                                    onClick={() => removeAlbum(index)}
                                                    className="opacity-0 group-hover:opacity-100 text-[#ff1744] hover:text-[#ff4569]"
                                                >
                                                    [ X ]
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MusicLibrary />);
    </script>
</body>

</html>